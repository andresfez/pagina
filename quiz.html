<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Quiz (P2)</title>

  <link rel="stylesheet" href="estilos.css">
  <style>
    .question{
      margin-top: 10px;
      font-size: clamp(17px, 2.2vw, 20px);
      line-height: 1.6;
    }
    .options{
      margin-top: 18px;
      display: grid;
      gap: 12px;
      grid-template-columns: 1fr;
      text-align: left;
    }
    @media (min-width: 720px){
      .options{ grid-template-columns: 1fr 1fr; }
    }
    .optBtn{
      width: 100%;
      padding: 14px 14px;
      border-radius: var(--radius-card);
      text-align: left;
    }
    .meta{
      margin-top: 14px;
    }
    .topActions{
      margin-top: 16px;
      display: flex;
      justify-content: center;
      gap: 12px;
      flex-wrap: wrap;
    }
  </style>
</head>

<body>
  <main class="card center">
    <h1>Quiz</h1>

    <p class="question" id="intro">
      A continuación presentará un quiz de cinco preguntas de selección múltiple.
      Instrucción: selecciona la opción correcta. Al fallar, vuelve a la pregunta 1.
    </p>

    <div class="box" style="margin-top:16px;">
      <p id="qTitle" style="margin:0 0 8px; font-weight:700; opacity:1;"></p>
      <p id="qText" class="question" style="margin:0;"></p>
    </div>

    <div class="options" id="options"></div>

    <p class="hint meta" id="progress"></p>
    <div id="msgBox" class="msg"></div>

    <div class="topActions">
      <button class="btn-secondary" id="btnMenu">Siguiente</button>
    </div>
  </main>

  <script>
    const FLAG = "quiz_p2_ok";
    const quiz = [
      {
        title: "Pregunta 1",
        text: "¿Cuántas canciones tiene la playlist mostrada tras seleccionar la opción 1 en el menú?.",
        options: ["227", "226", "228", "225"],
        correctIndex: 0
      },
      {
        title: "Pregunta 2",
        text: "¿Cuantos cambios de texto hubieron en la segunda página? (página entre registro y menú)",
        options: ["4", "5", "6", "No cuenta porque los «cambios de texto» implican un cambio de página, mas no un cambio de contenido de la pagina, manteniendo la misma página."],
        correctIndex: 1
      },
      {
        title: "Pregunta 3",
        text: "En una temporada previa ¿Por qué el autor dedicó DtMf?",
        options: ["Al autor le gustó el beat", "Por parlón", "Porque genuinamente sintió eso en el momento que pasó, y quería expresarlo mas no sabía como por lo que decidió dedicar una canción", "Bad Bunny es una chimba."],
        correctIndex: 2
      },
      {
        title: "Pregunta 4",
        text: "La verdad no tengo más imaginación para pensar en más preguntas so; originalmente la playlist fue creada con el fin de «mostrar la esencia del autor en una playlist musical», (efectivamente fue en Sptify porque creo que no usas Apple Music) asimismo se redujo de +500 canciones a las que quedaron. ¿Qué opina de que hayan tantos artistas y tanta diversidad? .",
        options: ["Que diversidad, eso es una excusa por indesición", "Gracias por mostrar un pedazo de los gustos musicales tuyos (autor)", "¿Por qué tanto gringo?", "A la próxima hagamos una playlist colaborativa, sea en Spotify o en Apple Music"],
        correctIndices: [0,1,2,3]
      },
      {
        title: "Pregunta 5",
        text: "¿Qué tal el intento de una actividad diferente, «aprovechando» la distancia?",
        options: ["Gas.", "Ya basta.", "Meh.", "Estuvo curioso, gracias por esforzarte autor :D"],
        correctIndex: 3
      }
    ];

    let i = 0; // índice de pregunta actual

    const qTitle = document.getElementById("qTitle");
    const qText = document.getElementById("qText");
    const optionsDiv = document.getElementById("options");
    const progress = document.getElementById("progress");
    const msgBox = document.getElementById("msgBox");

    function showMsg(type, text){
      msgBox.className = "msg " + type; // ok | err (usa estilos globales)
      msgBox.textContent = text;
    }

    function clearMsg(){
      msgBox.className = "msg";
      msgBox.textContent = "";
    }

    function renderQuestion(){
      clearMsg();

      const q = quiz[i];
      qTitle.textContent = q.title;
      qText.textContent = q.text;
      progress.textContent = `Pregunta ${i + 1} de ${quiz.length}`;

      optionsDiv.innerHTML = "";
      q.options.forEach((label, idx) => {
        const btn = document.createElement("button");
        btn.className = "optBtn";
        btn.type = "button";
        btn.textContent = label;

        btn.addEventListener("click", () => handleAnswer(idx));
        optionsDiv.appendChild(btn);
      });
    }

    function handleAnswer(chosenIndex){
      const q = quiz[i];
    
      const esCorrecto =
        (typeof q.correctIndex === "number" && chosenIndex === q.correctIndex) ||
        (Array.isArray(q.correctIndices) && q.correctIndices.includes(chosenIndex));
    
      if (esCorrecto){
        showMsg("ok", "Correcto.");
    
        setTimeout(() => {
          i++;
          if (i >= quiz.length){
            localStorage.setItem(FLAG, "1");
            window.location.href = "video.html";
          } else {
            renderQuestion();
          }
        }, 450);
    
      } else {
        showMsg("err", "Incorrecto. Vuelve a la pregunta 1.");
    
        setTimeout(() => {
          i = 0;
          renderQuestion();
        }, 650);
      }
    }


    document.getElementById("btnMenu").addEventListener("click", () => {
      window.location.href = "video.html";
    });

    // Inicial
    renderQuestion();
  </script>
</body>
</html>
